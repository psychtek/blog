---
title: Emotional Impact on Memory Part 2
author: Aaron Willcox
date: '2019-08-16'
slug: emotional-impact-on-memory-part-2
categories:
  - R
tags:
  - Emotion
  - R Markdown
  - research
subtitle: ''
summary: ''
authors: []
lastmod: '2019-08-16T10:30:23+10:00'
featured: no
image:
  caption: ''
  focal_point: ''
  preview_only: no
projects: []
---

<script src="/rmarkdown-libs/htmlwidgets/htmlwidgets.js"></script>
<script src="/rmarkdown-libs/jquery/jquery.min.js"></script>
<link href="/rmarkdown-libs/datatables-css/datatables-crosstalk.css" rel="stylesheet" />
<script src="/rmarkdown-libs/datatables-binding/datatables.js"></script>
<link href="/rmarkdown-libs/dt-core/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="/rmarkdown-libs/dt-core/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="/rmarkdown-libs/dt-core/js/jquery.dataTables.min.js"></script>
<link href="/rmarkdown-libs/crosstalk/css/crosstalk.css" rel="stylesheet" />
<script src="/rmarkdown-libs/crosstalk/js/crosstalk.min.js"></script>
<script src="/rmarkdown-libs/kePrint/kePrint.js"></script>


<div id="library" class="section level4">
<h4>Library</h4>
</div>
<div id="import" class="section level4">
<h4>Import</h4>
<p>Raw CSV files with all IAPS database and images to be used in each task imported into an object.</p>
<pre class="r"><code>raw_df &lt;- read_csv(&quot;data/ret_task.csv&quot;
                   , col_types = cols(CR = col_factor(levels = c(&quot;same&quot;,  &quot;different&quot;))
                   , Emotion = col_factor(levels = c(&quot;negative&quot;, &quot;neutral&quot;))
                  , Sex = col_factor(levels = c(&quot;male&quot;, &quot;female&quot;))))

raw_df$CorrectAnswer &lt;- recode(raw_df$CorrectAnswer, a = &quot;l&quot;, l = &quot;a&quot;)
raw_df$Stimulus1.RESP &lt;- recode(raw_df$Stimulus1.RESP, a = &quot;l&quot;, l = &quot;a&quot;)

# import tables 

RET_SEEN &lt;- read_csv(&quot;data/RET_SEEN.csv&quot;)
RET_UNSEEN_NEW &lt;- read_csv(&quot;data/RET_UNSEEN_NEW.csv&quot;)
RET_PS_a &lt;- read_csv(&quot;data/RET_PS_a.csv&quot;)</code></pre>
</div>
<div id="data-setup" class="section level4">
<h4>Data Setup</h4>
<ul>
<li><p>75 Negative Images</p></li>
<li><p>75 Neutral Images</p></li>
</ul>
<p>General d-prime score: p(hits|75) and then p(FA|75)</p>
<table>
<thead>
<tr class="header">
<th></th>
<th>SAME(A)</th>
<th>DIFFERENT(L)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>NEW</td>
<td>MISS(FA)</td>
<td>HIT(CR)</td>
</tr>
<tr class="even">
<td>OLD</td>
<td>MISS</td>
<td>MISS</td>
</tr>
<tr class="odd">
<td>SIMILAR</td>
<td>HIT</td>
<td>MISS</td>
</tr>
</tbody>
</table>
<div id="compute-new-variables" class="section level5">
<h5>Compute New Variables</h5>
<p>Pattern separation scores were calculated by comparing the <strong>CorrectAnswer</strong> response to the actual <strong>Stimulus1.RESP</strong> and then allocated either a <strong>hit</strong> or <strong>miss</strong> where appropriate. Futher variables were then computed as a binary response of <strong>1</strong> for a hit or <strong>0</strong> for a miss.</p>
<p>Negative and Neutral conditions were also computed as when a participant responded to a hit when a image is in the negative condition. Neutral was the compliment of this.</p>
<pre class="r"><code>raw_df &lt;- raw_df %&gt;% 
  select_all() %&gt;% 
  mutate(
    Pattern_Sep = case_when(
      CorrectAnswer == Stimulus1.RESP &amp; CorrectAnswer == &quot;a&quot;  ~ &quot;Hit&quot;, 
      # Condition checks to match correct answer to 
      CorrectAnswer == Stimulus1.RESP &amp; CorrectAnswer == &quot;l&quot; ~ &quot;Hit&quot;,  
      # the participants response. Labelled as &quot;hits&quot;
      CorrectAnswer != Stimulus1.RESP &amp; CorrectAnswer == &quot;l&quot; ~ &quot;Miss&quot;, 
      # and &quot;miss&quot; for easy identifying. 
      CorrectAnswer != Stimulus1.RESP &amp; CorrectAnswer == &quot;a&quot; ~ &quot;Miss&quot;,
      TRUE  ~ &quot;&quot;)) %&gt;% 
  mutate(
    Score = case_when(
      Pattern_Sep == &quot;Hit&quot; ~ 1, # A column of hits and misses coded 1 for hit and 0 for miss
      Pattern_Sep == &quot;Miss&quot; ~ 0
    )
  )  %&gt;% 
  mutate(
    Total_Hits = factor(case_when( # total counts for hits and misses
      Score == 1 ~ 1,
      Score == 0 ~ 0
    )),
    Total_Miss = factor(case_when(
      Score == 0 ~ 1,
      Score == 1 ~ 0
    ))
  )  %&gt;% 
  mutate(Hit_similar = factor(ifelse(CorrectAnswer %in% c(&quot;a&quot;) &amp;   
                                       # These columns count the appropriate hits and misses
                                Stimulus1.RESP == &quot;a&quot;, 1, 0)),      
         # for each emotional condition. 
         Negative_Hit = factor(ifelse(Emotion %in% c(&quot;negative&quot;) &amp;
                            Pattern_Sep == &quot;Hit&quot;, 1, 0)),
         Negative_Miss = factor(ifelse(Emotion %in% c(&quot;negative&quot;) &amp;
                              Pattern_Sep == &quot;Miss&quot;, 1, 0)),
         Neutral_Hit = factor(ifelse(Emotion %in% c(&quot;neutral&quot;) &amp;
                             Pattern_Sep == &quot;Hit&quot;, 1, 0)),
         Neutral_Miss = factor(ifelse(Emotion %in% c(&quot;neutral&quot;) &amp;
                                 Pattern_Sep == &quot;Miss&quot;, 1, 0)))
 
raw_df$Picture &lt;-  str_remove(raw_df$Picture, &quot;.jpg&quot;) #remove the jpg extention


# check the column picture number and compare to the originally coded
# tasks use to setup the experiment. 
raw_df &lt;- raw_df %&gt;% 
  mutate(
    coding = case_when(
      Picture %in% RET_PS_a$V1 ~ &quot;SIMILAR&quot;, 
      Picture %in% RET_UNSEEN_NEW$nr ~ &quot;NEW&quot;, 
      Picture %in% RET_SEEN$nr ~ &quot;OLD&quot;,
      TRUE ~ &quot;&quot;))

# Added pattern separation counts similar to Stark(2013)
raw_df &lt;- raw_df %&gt;% 
  mutate(pshits = ifelse(coding %in% c(&quot;SIMILAR&quot;) &amp; Stimulus1.RESP == &quot;a&quot;, 1, 0),
         psmiss = ifelse(coding %in% c(&quot;SIMILAR&quot;) &amp; Stimulus1.RESP == &quot;l&quot;, 1, 0),
         pscr = ifelse(coding %in% c(&quot;NEW&quot;) &amp; Stimulus1.RESP == &quot;l&quot;, 1, 0),
         psfa = ifelse(coding %in% c(&quot;NEW&quot;) &amp; Stimulus1.RESP == &quot;a&quot;, 1, 0))</code></pre>
</div>
</div>
<div id="grouping-variables-and-joining-to-long-format" class="section level4">
<h4>Grouping Variables and Joining To Long Format:</h4>
<p>Temporary tables are then created per subject based on hits and misses.</p>
<pre class="r"><code>a &lt;- raw_df %&gt;% group_by(Subject, Neutral_Hit) %&gt;% 
  tally() %&gt;% 
  filter(Neutral_Hit == 1) %&gt;% 
  select(n) %&gt;% 
  rename(Neutral_hits = n) 

b &lt;- raw_df %&gt;% group_by(Subject, Neutral_Miss) %&gt;% 
  tally() %&gt;% 
  filter(Neutral_Miss == 1) %&gt;% 
  select(n) %&gt;% 
  rename(Neutral_miss = n) 

c &lt;- raw_df %&gt;% group_by(Subject, Negative_Hit) %&gt;% 
  tally() %&gt;% 
  filter(Negative_Hit == 1) %&gt;% 
  select(n) %&gt;% 
  rename(Negative_hits = n) 

d &lt;- raw_df %&gt;% group_by(Subject, Negative_Miss) %&gt;% 
  tally() %&gt;% 
  filter(Negative_Miss == 1) %&gt;% 
  select(n) %&gt;% 
  rename(Negative_miss = n) 

e &lt;- full_join(a, b)

f &lt;- full_join(c, d)

g &lt;- full_join(e, f)


h &lt;- raw_df %&gt;% 
  group_by(Subject) %&gt;% 
  filter(Total_Hits == 1) %&gt;% 
  tally() %&gt;% 
  rename(&quot;Total_hits&quot; = n)

i &lt;- raw_df %&gt;% 
  group_by(Subject) %&gt;% 
  filter(Total_Miss == 1) %&gt;% 
  tally() %&gt;% 
  rename(&quot;Total_miss&quot; = n)

j &lt;- full_join(h, i)
k &lt;- full_join(g, j)

l &lt;- raw_df %&gt;% 
  select(Subject, Sex, Stimulus1.RT) %&gt;% 
  group_by(Subject, Sex) %&gt;% 
  summarise(MeanRT = mean(Stimulus1.RT), )

Ret_task_a &lt;- full_join(l, k)


m &lt;- raw_df %&gt;% 
  select(Subject, Sex, Emotion, Stimulus1.RT) %&gt;% 
  filter(Emotion == &quot;negative&quot;) %&gt;% 
  group_by(Subject, Sex) %&gt;% 
  summarise(Neg_RT = mean(Stimulus1.RT))

n &lt;- raw_df %&gt;% 
  select(Subject, Sex, Emotion, Stimulus1.RT) %&gt;% 
  filter(Emotion == &quot;neutral&quot;) %&gt;% 
  group_by(Subject, Sex) %&gt;% 
  summarise(Neut_RT = mean(Stimulus1.RT))

# ---
d1 &lt;- raw_df %&gt;% 
  group_by(Subject) %&gt;% 
  filter(Emotion == &quot;negative&quot; &amp; Hit_similar == &quot;1&quot;) %&gt;%
  tally() %&gt;%
  rename(&quot;Neg_Sim_Hit&quot; = n)

d2 &lt;- raw_df %&gt;% 
  group_by(Subject) %&gt;% 
  filter(Emotion == &quot;neutral&quot; &amp; Hit_similar == &quot;1&quot;) %&gt;%
  tally() %&gt;%
  rename(&quot;Neut_Sim_Hit&quot; = n)

Ret_task_c &lt;- full_join(d1, d2)

# ---

Ret_task_b &lt;- full_join(m, n)  

Ret_task_d &lt;- full_join(Ret_task_b, Ret_task_c)

Ret_task_df_temp &lt;- full_join(Ret_task_a, Ret_task_d) # temp join of data tables

pattern_sep_scores &lt;- raw_df %&gt;% 
  group_by(Subject, Sex) %&gt;% 
  summarise(n_hits = sum(pshits)
            , n_miss = sum(psmiss)
            , n_cr = sum(pscr)
            , n_fa = sum(psfa)) %&gt;% 
  mutate(n_hits = replace(n_hits, which(is.na(n_hits)), 0)) %&gt;% 
  mutate(n_miss = replace(n_miss, which(is.na(n_miss)), 0)) %&gt;% 
  mutate(n_cr = replace(n_cr, which(is.na(n_cr)), 0)) %&gt;% 
  mutate(n_fa = replace(n_fa, which(is.na(n_fa)), 0))

 
 
pattern_sep_scores &lt;- pattern_sep_scores  %&gt;% 
  mutate(Perc_correct = (n_hits + n_cr)/(n_hits + n_miss + n_fa +n_cr)
         , Dprime = (n_hits/(n_hits + n_miss)-(n_fa/(n_fa + n_cr))))

Ret_task_df_join &lt;-  full_join(Ret_task_df_temp, pattern_sep_scores)


datatable(Ret_task_df_join)</code></pre>
<div id="htmlwidget-1" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-1">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58"],[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,50,51,52,53,54,55,56,57,58,59],["female","female","female","female","female","female","female","female","female","female","female","female","female","female","male","female","female","female","female","female","male","female","female","female","female","male","female","male","male","male","female","female","female","female","female","female","female","female","female","female","male","female","male","female","male","male","female","female","male","female","male","female","female","male","female","female","female","male"],[0,1298.66666666667,10.52,1525.94666666667,1213.78,1799.62,1119.41333333333,1217.12,744.86,1304.34,1294.08666666667,1481.85333333333,1198.86666666667,1226.98,1439.39333333333,1254.48666666667,1455.61333333333,1785.65333333333,1252.78,1431.15333333333,1131.36,1609.92666666667,1436.04666666667,1581.80666666667,2077.56,1302.44666666667,1296.04,1613,1530.57333333333,1603.76666666667,1780.80666666667,1547.81333333333,1611.20666666667,1794.96,1505.66666666667,1487.03333333333,1520.32666666667,1531.78666666667,954.386666666667,1763.06,1261.64,1394.30666666667,1757.8,1673.36666666667,1483.72666666667,1496.02,1354.52666666667,1414.34,1669.83333333333,1150.92,1635.57333333333,1553.92666666667,1379.62,2022.31333333333,1032.76666666667,1129.14666666667,1311.34,1954.56666666667],[null,9,1,53,63,49,69,55,38,60,63,57,59,58,65,55,68,56,65,61,58,59,67,67,58,62,57,64,64,62,65,64,54,62,61,65,68,64,65,56,57,63,65,63,58,67,60,50,58,52,69,65,58,52,44,64,53,50],[null,66,null,22,12,19,6,20,7,15,12,17,16,16,9,19,7,19,10,14,17,16,8,8,14,13,18,11,11,11,9,11,21,13,14,10,7,11,10,19,18,12,8,12,17,8,15,25,17,23,6,10,17,22,8,11,22,24],[null,9,null,57,63,46,69,45,33,53,65,62,55,57,65,52,64,55,64,62,56,66,68,58,55,52,52,64,65,67,66,61,56,60,59,53,66,61,58,67,63,59,59,62,64,65,67,61,62,52,62,59,65,46,43,68,64,46],[null,66,null,18,12,18,6,30,11,22,10,13,20,18,10,23,11,20,10,13,19,9,6,16,18,23,23,11,10,7,7,14,19,15,16,22,9,14,17,8,12,16,10,13,11,10,8,14,13,23,12,15,10,28,9,7,11,27],[null,18,1,110,126,95,138,100,71,113,128,119,114,115,130,107,132,111,129,123,114,125,135,125,113,114,109,128,129,129,131,125,110,122,120,118,134,125,123,123,120,122,124,125,122,132,127,111,120,104,131,124,123,98,87,132,117,96],[null,132,null,40,24,37,12,50,18,37,22,30,36,34,19,42,18,39,20,27,36,25,14,24,32,36,41,22,21,18,16,25,40,28,30,32,16,25,27,27,30,28,18,25,28,18,23,39,30,46,18,25,27,50,17,18,33,51],[0,1436.54666666667,0,1542.25333333333,1331.24,1801.16,1180.41333333333,1335.93333333333,720.533333333333,1379.02666666667,1435.82666666667,1710.89333333333,1275.65333333333,1303.58666666667,1578.14666666667,1300.25333333333,1567.52,1881.14666666667,1306.61333333333,1572.25333333333,1182.74666666667,1662.46666666667,1443.50666666667,1752.22666666667,2146.66666666667,1371.09333333333,1356.54666666667,1672.26666666667,1603.96,1743.04,2002.08,1741.22666666667,1787,1894.76,1682.26666666667,1606.81333333333,1728.26666666667,1612.97333333333,1026.22666666667,1978.97333333333,1293.29333333333,1407.12,1848.41333333333,1843.32,1587.05333333333,1620.12,1481.8,1449.64,1702.42666666667,1286.36,1728.53333333333,1743.64,1422.98666666667,2056.34666666667,1141.70666666667,1175.32,1411.66666666667,1985.09333333333],[0,1160.78666666667,21.04,1509.64,1096.32,1798.08,1058.41333333333,1098.30666666667,769.186666666667,1229.65333333333,1152.34666666667,1252.81333333333,1122.08,1150.37333333333,1300.64,1208.72,1343.70666666667,1690.16,1198.94666666667,1290.05333333333,1079.97333333333,1557.38666666667,1428.58666666667,1411.38666666667,2008.45333333333,1233.8,1235.53333333333,1553.73333333333,1457.18666666667,1464.49333333333,1559.53333333333,1354.4,1435.41333333333,1695.16,1329.06666666667,1367.25333333333,1312.38666666667,1450.6,882.546666666667,1547.14666666667,1229.98666666667,1381.49333333333,1667.18666666667,1503.41333333333,1380.4,1371.92,1227.25333333333,1379.04,1637.24,1015.48,1542.61333333333,1364.21333333333,1336.25333333333,1988.28,923.826666666667,1082.97333333333,1211.01333333333,1924.04],[null,1,null,15,21,16,23,15,3,15,20,18,21,14,22,19,18,22,24,25,16,18,23,20,20,21,22,19,21,22,22,21,8,17,17,12,23,24,23,22,17,19,21,20,23,22,24,17,14,22,18,21,23,21,11,22,20,11],[null,5,null,12,21,11,25,15,10,13,17,19,19,14,19,19,23,20,20,23,15,15,20,22,22,18,18,18,23,21,21,21,8,16,20,20,21,21,21,15,14,19,24,20,22,23,17,9,8,17,22,20,15,19,10,19,11,11],[0,40,0,13,12,0,8,21,0,9,9,16,20,10,6,21,9,20,0,19,12,7,6,11,0,19,22,6,12,0,9,13,6,5,14,12,7,15,16,12,10,13,0,13,18,11,11,11,2,28,0,11,13,27,0,8,12,0],[0,10,0,37,38,0,42,29,0,41,41,34,30,40,44,29,41,30,0,31,38,43,44,39,0,31,28,44,38,0,41,37,44,45,36,38,43,35,34,38,40,37,0,37,32,39,39,39,48,22,0,39,37,23,0,42,38,0],[0,2,0,46,46,0,48,41,0,44,50,48,44,0,45,0,50,39,49,44,45,49,0,44,0,44,41,47,47,0,0,46,50,44,47,48,47,45,45,48,49,47,0,48,45,48,47,46,50,43,50,0,48,0,0,49,48,46],[0,48,0,4,4,0,2,9,0,6,0,2,6,0,5,0,0,11,1,6,5,1,0,6,0,6,9,3,3,0,0,4,0,6,3,2,3,5,5,2,1,3,0,2,5,2,3,4,0,7,0,0,2,0,0,1,2,4],[null,0.42,null,0.59,0.58,null,0.56,0.62,null,0.53,0.59,0.64,0.64,0.2,0.51,0.42,0.59,0.59,0.98,0.63,0.57,0.56,0.12,0.55,null,0.63,0.63,0.53,0.59,null,0.18,0.59,0.56,0.49,0.61,0.6,0.54,0.6,0.61,0.6,0.59,0.6,null,0.61,0.63,0.59,0.58,0.57,0.52,0.71,1,0.22,0.61,0.54,null,0.57,0.6,0.92],[null,-0.16,null,0.18,0.16,null,0.12,0.24,null,0.06,0.18,0.28,0.28,null,0.02,null,0.18,0.18,null,0.26,0.14,0.12,null,0.1,null,0.26,0.26,0.06,0.18,null,null,0.18,0.12,-0.02,0.22,0.2,0.08,0.2,0.22,0.2,0.18,0.2,null,0.22,0.26,0.18,0.16,0.14,0.04,0.42,null,null,0.22,null,null,0.14,0.2,null]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Subject<\/th>\n      <th>Sex<\/th>\n      <th>MeanRT<\/th>\n      <th>Neutral_hits<\/th>\n      <th>Neutral_miss<\/th>\n      <th>Negative_hits<\/th>\n      <th>Negative_miss<\/th>\n      <th>Total_hits<\/th>\n      <th>Total_miss<\/th>\n      <th>Neg_RT<\/th>\n      <th>Neut_RT<\/th>\n      <th>Neg_Sim_Hit<\/th>\n      <th>Neut_Sim_Hit<\/th>\n      <th>n_hits<\/th>\n      <th>n_miss<\/th>\n      <th>n_cr<\/th>\n      <th>n_fa<\/th>\n      <th>Perc_correct<\/th>\n      <th>Dprime<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="validation-task-data" class="section level4">
<h4>Validation Task Data</h4>
<p>Validation database imported into an object</p>
<pre class="r"><code>val_task &lt;- read_csv(file = &quot;data/val_task.csv&quot;)</code></pre>
<p>A table is created by grouping by each subject and then a new variable is computed for each emotion score dimension.
There is also response times for each image but wont be using those for this analysis.</p>
<pre class="r"><code>val_df &lt;- val_task %&gt;% 
  group_by(Subject) %&gt;% 
  summarise(Arousal = mean(arousal.RESP), Valence = mean(valence.RESP), Dominance = mean(dominance.RESP))</code></pre>
</div>
<div id="full-join-of-both-tasks-to-one-dataframe-in-wide-format" class="section level4">
<h4>Full join of both tasks to one dataframe in wide format</h4>
<pre class="r"><code>val_df$Subject &lt;- as.factor(val_df$Subject)

Ret_task_df_join$Subject &lt;- as.factor(Ret_task_df_join$Subject)

group_39_wide &lt;- full_join(Ret_task_df_join, val_df) # Final data table with all computed results

datatable(group_39_wide)</code></pre>
<div id="htmlwidget-2" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-2">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58"],["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","50","51","52","53","54","55","56","57","58","59"],["female","female","female","female","female","female","female","female","female","female","female","female","female","female","male","female","female","female","female","female","male","female","female","female","female","male","female","male","male","male","female","female","female","female","female","female","female","female","female","female","male","female","male","female","male","male","female","female","male","female","male","female","female","male","female","female","female","male"],[0,1298.66666666667,10.52,1525.94666666667,1213.78,1799.62,1119.41333333333,1217.12,744.86,1304.34,1294.08666666667,1481.85333333333,1198.86666666667,1226.98,1439.39333333333,1254.48666666667,1455.61333333333,1785.65333333333,1252.78,1431.15333333333,1131.36,1609.92666666667,1436.04666666667,1581.80666666667,2077.56,1302.44666666667,1296.04,1613,1530.57333333333,1603.76666666667,1780.80666666667,1547.81333333333,1611.20666666667,1794.96,1505.66666666667,1487.03333333333,1520.32666666667,1531.78666666667,954.386666666667,1763.06,1261.64,1394.30666666667,1757.8,1673.36666666667,1483.72666666667,1496.02,1354.52666666667,1414.34,1669.83333333333,1150.92,1635.57333333333,1553.92666666667,1379.62,2022.31333333333,1032.76666666667,1129.14666666667,1311.34,1954.56666666667],[null,9,1,53,63,49,69,55,38,60,63,57,59,58,65,55,68,56,65,61,58,59,67,67,58,62,57,64,64,62,65,64,54,62,61,65,68,64,65,56,57,63,65,63,58,67,60,50,58,52,69,65,58,52,44,64,53,50],[null,66,null,22,12,19,6,20,7,15,12,17,16,16,9,19,7,19,10,14,17,16,8,8,14,13,18,11,11,11,9,11,21,13,14,10,7,11,10,19,18,12,8,12,17,8,15,25,17,23,6,10,17,22,8,11,22,24],[null,9,null,57,63,46,69,45,33,53,65,62,55,57,65,52,64,55,64,62,56,66,68,58,55,52,52,64,65,67,66,61,56,60,59,53,66,61,58,67,63,59,59,62,64,65,67,61,62,52,62,59,65,46,43,68,64,46],[null,66,null,18,12,18,6,30,11,22,10,13,20,18,10,23,11,20,10,13,19,9,6,16,18,23,23,11,10,7,7,14,19,15,16,22,9,14,17,8,12,16,10,13,11,10,8,14,13,23,12,15,10,28,9,7,11,27],[null,18,1,110,126,95,138,100,71,113,128,119,114,115,130,107,132,111,129,123,114,125,135,125,113,114,109,128,129,129,131,125,110,122,120,118,134,125,123,123,120,122,124,125,122,132,127,111,120,104,131,124,123,98,87,132,117,96],[null,132,null,40,24,37,12,50,18,37,22,30,36,34,19,42,18,39,20,27,36,25,14,24,32,36,41,22,21,18,16,25,40,28,30,32,16,25,27,27,30,28,18,25,28,18,23,39,30,46,18,25,27,50,17,18,33,51],[0,1436.54666666667,0,1542.25333333333,1331.24,1801.16,1180.41333333333,1335.93333333333,720.533333333333,1379.02666666667,1435.82666666667,1710.89333333333,1275.65333333333,1303.58666666667,1578.14666666667,1300.25333333333,1567.52,1881.14666666667,1306.61333333333,1572.25333333333,1182.74666666667,1662.46666666667,1443.50666666667,1752.22666666667,2146.66666666667,1371.09333333333,1356.54666666667,1672.26666666667,1603.96,1743.04,2002.08,1741.22666666667,1787,1894.76,1682.26666666667,1606.81333333333,1728.26666666667,1612.97333333333,1026.22666666667,1978.97333333333,1293.29333333333,1407.12,1848.41333333333,1843.32,1587.05333333333,1620.12,1481.8,1449.64,1702.42666666667,1286.36,1728.53333333333,1743.64,1422.98666666667,2056.34666666667,1141.70666666667,1175.32,1411.66666666667,1985.09333333333],[0,1160.78666666667,21.04,1509.64,1096.32,1798.08,1058.41333333333,1098.30666666667,769.186666666667,1229.65333333333,1152.34666666667,1252.81333333333,1122.08,1150.37333333333,1300.64,1208.72,1343.70666666667,1690.16,1198.94666666667,1290.05333333333,1079.97333333333,1557.38666666667,1428.58666666667,1411.38666666667,2008.45333333333,1233.8,1235.53333333333,1553.73333333333,1457.18666666667,1464.49333333333,1559.53333333333,1354.4,1435.41333333333,1695.16,1329.06666666667,1367.25333333333,1312.38666666667,1450.6,882.546666666667,1547.14666666667,1229.98666666667,1381.49333333333,1667.18666666667,1503.41333333333,1380.4,1371.92,1227.25333333333,1379.04,1637.24,1015.48,1542.61333333333,1364.21333333333,1336.25333333333,1988.28,923.826666666667,1082.97333333333,1211.01333333333,1924.04],[null,1,null,15,21,16,23,15,3,15,20,18,21,14,22,19,18,22,24,25,16,18,23,20,20,21,22,19,21,22,22,21,8,17,17,12,23,24,23,22,17,19,21,20,23,22,24,17,14,22,18,21,23,21,11,22,20,11],[null,5,null,12,21,11,25,15,10,13,17,19,19,14,19,19,23,20,20,23,15,15,20,22,22,18,18,18,23,21,21,21,8,16,20,20,21,21,21,15,14,19,24,20,22,23,17,9,8,17,22,20,15,19,10,19,11,11],[0,40,0,13,12,0,8,21,0,9,9,16,20,10,6,21,9,20,0,19,12,7,6,11,0,19,22,6,12,0,9,13,6,5,14,12,7,15,16,12,10,13,0,13,18,11,11,11,2,28,0,11,13,27,0,8,12,0],[0,10,0,37,38,0,42,29,0,41,41,34,30,40,44,29,41,30,0,31,38,43,44,39,0,31,28,44,38,0,41,37,44,45,36,38,43,35,34,38,40,37,0,37,32,39,39,39,48,22,0,39,37,23,0,42,38,0],[0,2,0,46,46,0,48,41,0,44,50,48,44,0,45,0,50,39,49,44,45,49,0,44,0,44,41,47,47,0,0,46,50,44,47,48,47,45,45,48,49,47,0,48,45,48,47,46,50,43,50,0,48,0,0,49,48,46],[0,48,0,4,4,0,2,9,0,6,0,2,6,0,5,0,0,11,1,6,5,1,0,6,0,6,9,3,3,0,0,4,0,6,3,2,3,5,5,2,1,3,0,2,5,2,3,4,0,7,0,0,2,0,0,1,2,4],[null,0.42,null,0.59,0.58,null,0.56,0.62,null,0.53,0.59,0.64,0.64,0.2,0.51,0.42,0.59,0.59,0.98,0.63,0.57,0.56,0.12,0.55,null,0.63,0.63,0.53,0.59,null,0.18,0.59,0.56,0.49,0.61,0.6,0.54,0.6,0.61,0.6,0.59,0.6,null,0.61,0.63,0.59,0.58,0.57,0.52,0.71,1,0.22,0.61,0.54,null,0.57,0.6,0.92],[null,-0.16,null,0.18,0.16,null,0.12,0.24,null,0.06,0.18,0.28,0.28,null,0.02,null,0.18,0.18,null,0.26,0.14,0.12,null,0.1,null,0.26,0.26,0.06,0.18,null,null,0.18,0.12,-0.02,0.22,0.2,0.08,0.2,0.22,0.2,0.18,0.2,null,0.22,0.26,0.18,0.16,0.14,0.04,0.42,null,null,0.22,null,null,0.14,0.2,null],[null,4.63,null,5.36,3.98,5.1,4.67,5.41,5.21,4.3,4.18,2.21,4.52,2.76,4.27,5.58,3.88,4.29,4.23,3.92,2.36,3.94,4.68,3.66,4.98,5.29,5.07,4.36,4.98,4.05,4.26,3.66,4.87,1.73,2.51,5.18,4.7,4.01,4.27,4.46,4.99,4.64,4.05,3.12,3.85,4.18,4.99,3.78,5.25,3.42,4.43,4.79,4.82,2.63,5.7,1.09,6.78,4.48],[null,null,null,3.93,3.9,4.59,4.22,4.43,4.29,5.2,4.93,4.49,4.2,6.66,3.35,4.08,4.05,5.2,4.9,5.91,5.45,4.38,3.93,4.74,4.77,3.71,4.49,4.31,4.61,4.98,4.18,4.68,3.99,3.9,4.7,3.91,5.17,5.98,4.13,4.38,3.55,4.38,4.63,4.21,4.55,4.34,4.84,5.03,4.08,4.73,4.89,4.86,4.77,6,3.96,5,3.4,3.83],[null,null,null,4.17,4.97,5.63,5.59,4.93,5.19,5.52,4.86,7.84,5.29,7.58,4.98,4.31,5.77,5.59,5.79,5.53,5.35,5.27,4.58,5.83,5.08,4.4,4.86,5.09,4.92,6.2,6.89,6.23,4.89,5.09,5.11,4.87,5.04,7.03,5.76,6.57,6.76,4.97,5.2,3.29,5.62,6.52,5.27,6.12,3.85,5.15,5.84,5.45,5.67,6.78,5.26,8.76,3.99,4.94]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Subject<\/th>\n      <th>Sex<\/th>\n      <th>MeanRT<\/th>\n      <th>Neutral_hits<\/th>\n      <th>Neutral_miss<\/th>\n      <th>Negative_hits<\/th>\n      <th>Negative_miss<\/th>\n      <th>Total_hits<\/th>\n      <th>Total_miss<\/th>\n      <th>Neg_RT<\/th>\n      <th>Neut_RT<\/th>\n      <th>Neg_Sim_Hit<\/th>\n      <th>Neut_Sim_Hit<\/th>\n      <th>n_hits<\/th>\n      <th>n_miss<\/th>\n      <th>n_cr<\/th>\n      <th>n_fa<\/th>\n      <th>Perc_correct<\/th>\n      <th>Dprime<\/th>\n      <th>Arousal<\/th>\n      <th>Valence<\/th>\n      <th>Dominance<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="descriptives" class="section level4">
<h4>Descriptives</h4>
<pre class="r"><code>my_fun &lt;- function(x, num_var){
  num_var &lt;- enquo(num_var)

  x %&gt;%
    summarize(avg = mean(!!num_var), n = n(), 
              sd = sd(!!num_var), se = sd/sqrt(n))
}

mean_response_time &lt;- group_39_wide %&gt;%
  group_by(Sex) %&gt;%
  my_fun(MeanRT)

neg_similar_hits &lt;- group_39_wide %&gt;%
  group_by(Sex) %&gt;%
  na.omit() %&gt;% 
  my_fun(Neg_Sim_Hit)

kable(mean_response_time) %&gt;% kable_styling()</code></pre>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Sex
</th>
<th style="text-align:right;">
avg
</th>
<th style="text-align:right;">
n
</th>
<th style="text-align:right;">
sd
</th>
<th style="text-align:right;">
se
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
male
</td>
<td style="text-align:right;">
1564.430
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
247.320
</td>
<td style="text-align:right;">
66.09905
</td>
</tr>
<tr>
<td style="text-align:left;">
female
</td>
<td style="text-align:right;">
1352.464
</td>
<td style="text-align:right;">
44
</td>
<td style="text-align:right;">
389.461
</td>
<td style="text-align:right;">
58.71346
</td>
</tr>
</tbody>
</table>
<pre class="r"><code>kable(neg_similar_hits) %&gt;% kable_styling()</code></pre>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Sex
</th>
<th style="text-align:right;">
avg
</th>
<th style="text-align:right;">
n
</th>
<th style="text-align:right;">
sd
</th>
<th style="text-align:right;">
se
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
male
</td>
<td style="text-align:right;">
19.44444
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
3.126944
</td>
<td style="text-align:right;">
1.0423146
</td>
</tr>
<tr>
<td style="text-align:left;">
female
</td>
<td style="text-align:right;">
19.58065
</td>
<td style="text-align:right;">
31
</td>
<td style="text-align:right;">
3.801528
</td>
<td style="text-align:right;">
0.6827745
</td>
</tr>
</tbody>
</table>
</div>
<div id="emotion-scores" class="section level4">
<h4>Emotion Scores</h4>
<pre class="r"><code># Gather variables and change to wide format
ret_long &lt;- group_39_wide %&gt;% 
  gather(key, value, Valence, Arousal, Dominance) %&gt;%
  select(Subject, key, value, Sex) %&gt;% 
  rename(&quot;Emotion&quot; = key) %&gt;% 
  arrange(desc(Subject))

ggplot(data = ret_long) +
  aes(x = value) +
  geom_histogram(bins = 30, fill = &quot;#1f78b4&quot;) +
  labs(title = &quot;Distribution of Emotion Response Scores&quot;,
    x = &quot;Mean Scores&quot;,
    y = &quot;Ratings&quot;,
    subtitle = &quot;IAPS Scores&quot;) +
  theme_cowplot() +
  facet_wrap(vars(Emotion))</code></pre>
<p><img src="/post/2019-08-16-emotional-impact-on-memory-part-2_files/figure-html/emotion-1.png" width="864" /></p>
</div>
<div id="emotion-ratings-from-negative-stimuli" class="section level4">
<h4>Emotion Ratings from Negative Stimuli</h4>
<pre class="r"><code># Negative Emotion Scores
val_task %&gt;% 
  filter(condition == &quot;negative&quot;) %&gt;% 
  na.omit() %&gt;% 
  group_by(Subject, Sex) %&gt;% 
  summarise(Arousal = mean(arousal.RESP)
            , Dominance = mean(dominance.RESP)
            , Valence = mean(valence.RESP)) %&gt;% 
  gather(key, value, Arousal, Dominance, Valence) %&gt;% 
  rename(&quot;Emotion&quot; = key) %&gt;% 
  ggplot(aes(x = value)) +
  geom_histogram(bins = 20, fill = &quot;#1f78b4&quot;) +
  labs(title = &quot;Emotion Scores from Negative Stimuli&quot;,
       y = &quot;Response&quot;,
    subtitle = &quot;Arousal, Dominance and Valence&quot;) +
  theme_cowplot() +
  facet_wrap(vars(Emotion))</code></pre>
<p><img src="/post/2019-08-16-emotional-impact-on-memory-part-2_files/figure-html/unnamed-chunk-6-1.png" width="864" /></p>
<p>As expected, negative stimuli have a higher arousal rating and lower valence rating.</p>
</div>
<div id="emotion-ratings-from-neutral-stimuli" class="section level4">
<h4>Emotion Ratings from Neutral Stimuli</h4>
<pre class="r"><code># Neutral Emotion Scores
val_task %&gt;% 
  filter(condition == &quot;neutral&quot;) %&gt;% 
  na.omit() %&gt;% 
  group_by(Subject, Sex) %&gt;% 
  summarise(Arousal = mean(arousal.RESP)
            , Dominance = mean(dominance.RESP)
            , Valence = mean(valence.RESP)) %&gt;% 
  gather(key, value, Arousal, Dominance, Valence) %&gt;% 
  rename(&quot;Emotion&quot; = key) %&gt;% 
  ggplot(aes(x = value)) +
  geom_histogram(bins = 20, fill = &quot;#1f78b4&quot;) +
  labs(title = &quot;Emotion Scores from the Neutral Condition&quot;,
    subtitle = &quot;Arousal, Dominance and Valence&quot;) +
  theme_cowplot() +
  facet_wrap(vars(Emotion))</code></pre>
<p><img src="/post/2019-08-16-emotional-impact-on-memory-part-2_files/figure-html/unnamed-chunk-7-1.png" width="864" /></p>
<p>This is what we would expect. Neutral stimuli should have low arousal ratings and higher valence ratings.</p>
</div>
<div id="histogram-of-total-negative-and-neutral-condition-hits" class="section level4">
<h4>Histogram of Total Negative and Neutral Condition hits</h4>
<pre class="r"><code>group_39_wide %&gt;% 
  gather(key, value, Neutral_hits, Negative_hits) %&gt;% # change to long format
  select(Subject, Sex, key, value) %&gt;%
  na.omit() %&gt;% 
  ggplot(aes(x = value)) +
  geom_histogram(bins = 22, fill = &quot;#1f78b4&quot;) +
  theme_cowplot() +
  facet_wrap(vars(key)) +
  geom_vline(aes(xintercept = mean(value)), linetype = &quot;dashed&quot;) </code></pre>
<p><img src="/post/2019-08-16-emotional-impact-on-memory-part-2_files/figure-html/unnamed-chunk-8-1.png" width="864" /></p>
</div>
<div id="negative-similar-hits-male-vs-females" class="section level4">
<h4>Negative Similar Hits (Male vs Females)</h4>
<p>This is our overall indicator of if there is evidence of pattern separation performance. The ability to detect
a image that was seen in the encoding task and recall if it they had seen it previously.</p>
<pre class="r"><code>group_39_wide %&gt;% 
  select(Sex, Neg_Sim_Hit, Subject) %&gt;%
  na.omit() %&gt;% 
  ggplot(aes(x = Neg_Sim_Hit)) +
  geom_histogram(bins = 22, fill = &quot;#1f78b4&quot;) +
  labs(title = &quot;Negative Similar Hits&quot;,
    subtitle = &quot;Male and Females&quot;) +
  theme_cowplot() +
  facet_wrap(vars(Sex)) +
  geom_vline(data = na.omit(group_39_wide), aes(xintercept = mean(Neg_Sim_Hit)), linetype = &quot;dashed&quot;)</code></pre>
<p><img src="/post/2019-08-16-emotional-impact-on-memory-part-2_files/figure-html/unnamed-chunk-9-1.png" width="864" /></p>
</div>
<div id="neutral-simiar-hits-male-vs-females" class="section level4">
<h4>Neutral Simiar Hits (Male vs Females)</h4>
<pre class="r"><code>group_39_wide %&gt;% 
  select(Sex, Neut_Sim_Hit, Subject) %&gt;%
  na.omit() %&gt;% 
  ggplot(aes(x = Neut_Sim_Hit)) +
  geom_histogram(bins = 22, fill = &quot;#1f78b4&quot;) +
  labs(title = &quot;Neutral Similar Hits&quot;,
    subtitle = &quot;Male and Females&quot;) +
  theme_cowplot() +
  facet_wrap(vars(Sex)) +
  geom_vline(data = na.omit(group_39_wide), aes(xintercept = mean(Neut_Sim_Hit)), linetype = &quot;dashed&quot;)</code></pre>
<p><img src="/post/2019-08-16-emotional-impact-on-memory-part-2_files/figure-html/unnamed-chunk-10-1.png" width="864" /></p>
</div>
<div id="validated-vs-fake-comparisons" class="section level4">
<h4>Validated vs Fake Comparisons</h4>
<p>We need to check if the altered images were eliciting a similar emotional response as to the
original IAPS validated images. There should be no difference between dimensions specifically, arousal and valence. If there is a difference then we dont know if we are actually eliciting the same response from participants as we want to.</p>
<p>I had already processed this file previous created a file with two groups. Group “a” is the original IAPS images with the means and sds taken from the manual. Group “b” is the altered images used in the retrieval task.</p>
<pre class="r"><code>IAPS_Fake_df &lt;- read_csv(&quot;data/validation_task_df.csv&quot;, # import data
    col_types = cols(Group = col_factor(levels = c(&quot;b&quot;, 
        &quot;a&quot;)), aromn = col_number(), dommn = col_number(), 
        valmn = col_number()), na = &quot;0&quot;)


# Change to long format

IAPS_Fake_df &lt;- IAPS_Fake_df %&gt;% 
  gather(key, value, aromn, valmn, dommn) %&gt;% 
  rename(&quot;Emotion&quot; = key)

IAPS_Fake_df$Emotion &lt;- as.factor(IAPS_Fake_df$Emotion)
IAPS_Fake_df$Group &lt;- as.factor(IAPS_Fake_df$Group)

library(cowplot)

IAPS_Fake_df %&gt;% 
  na.omit() %&gt;% 
ggplot() +
 aes(x = Emotion, y = value, fill = Group, colour = Group) +
 geom_boxplot() +
 scale_fill_hue() +
 scale_color_hue() +
 labs(x = &quot;Emotion&quot;, y = &quot;Mean Arousal Score&quot;, title = &quot;Validated vs Fake Comparison&quot;, subtitle = &quot;Original IAPS Images with Altered Images&quot;) +
 theme_cowplot() +
 theme(legend.position = &quot;none&quot;) +
 facet_wrap(vars(Group))</code></pre>
<p><img src="/post/2019-08-16-emotional-impact-on-memory-part-2_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>Boxplot seems to indicate we are getting pretty similar responses to the IAPS images.</p>
<pre class="r"><code>library(ggpubr)

comparison &lt;- compare_means(value ~ Emotion, group.by = &quot;Group&quot;,  data = IAPS_Fake_df)

comparison</code></pre>
<pre><code>## # A tibble: 6 x 9
##   Group .y.   group1 group2        p   p.adj p.format p.signif method  
##   &lt;fct&gt; &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;    &lt;chr&gt;   
## 1 b     value aromn  dommn  0.109    0.33    0.10930  ns       Wilcoxon
## 2 b     value aromn  valmn  0.150    0.33    0.15010  ns       Wilcoxon
## 3 b     value dommn  valmn  0.00362  0.014   0.00362  **       Wilcoxon
## 4 a     value aromn  dommn  0.992    0.99    0.99175  ns       Wilcoxon
## 5 a     value aromn  valmn  0.000505 0.0025  0.00051  ***      Wilcoxon
## 6 a     value dommn  valmn  0.000203 0.00120 0.00020  ***      Wilcoxon</code></pre>
</div>
<div id="data-analysis" class="section level4">
<h4>Data Analysis</h4>
<ol style="list-style-type: decimal">
<li><p>Participants will show increased pattern separation scores on high arousal trials versus low-arousal trials.</p></li>
<li><p>We expect an interaction effect between sex and emotion, females will have a higher pattern separation score than males for negative stimuli only.</p></li>
</ol>
<p>Next post will go through how to conduct a split-plot anova and analyse the results.</p>
</div>
